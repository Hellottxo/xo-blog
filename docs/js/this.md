# thisçš„æŒ‡å‘

é™¤äº†åœ¨å‡½æ•°å®šä¹‰ä¸­æ˜¾å¼å£°æ˜Žçš„å‚æ•°ä¹‹å¤–ï¼Œå‡½æ•°è°ƒç”¨æ—¶è¿˜ä¼šä¼ é€’ä¸¤ä¸ªéšå¼çš„å‚æ•°ï¼šargumentså’Œthisã€‚**thisçš„æŒ‡å‘ä¸ä»…æ˜¯ç”±å®šä¹‰å‡½æ•°çš„æ–¹å¼å’Œä½ç½®å†³å®šçš„ï¼ŒåŒæ—¶è¿˜ä¸¥é‡å—åˆ°å‡½æ•°è°ƒç”¨æ–¹å¼çš„å½±å“ã€‚**

å‡½æ•°è°ƒç”¨çš„æ–¹å¼é€šå¸¸åˆ†ä¸ºå››ç§ï¼šç›´æŽ¥è°ƒç”¨ï¼›ä½œä¸ºæ–¹æ³•è°ƒç”¨ï¼›é€šè¿‡`apply()`/`call()`çš„æ–¹å¼è°ƒç”¨ï¼›ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨ã€‚ä¸ºäº†å¯¹è¿™å››ç§è°ƒç”¨æ–¹å¼æœ‰æ›´æ¸…æ™°çš„è®¤çŸ¥ï¼Œæˆ‘ä»¬æ€»æ˜¯ç”¨ç›´æŽ¥è°ƒç”¨çš„æ–¹å¼æ¥è¿›è¡Œå¯¹æ¯”ã€‚

## 1. ç›´æŽ¥è°ƒç”¨

```js
function setName() {
  this.name = 'Betty';
}
setName();
console.log(window.name); // 'Betty'

function setStrictName() {
  'use strict';
  this.name = 'Betty';
}
setStrictName(); // Uncaught TypeError: Cannot set property 'name' of undefined
```

éžä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ`this`çš„æŒ‡å‘ç»‘å®šåˆ°windowï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ`this`çš„æŒ‡å‘undefinedã€‚

## 2. ä½œä¸ºæ–¹æ³•è°ƒç”¨

```js
const obj = {
  name: 'Mary',
  setName: function () {
  	this.name = 'Betty';
	}
};
obj.setName();
console.log(obj.name); // 'Betty'
```

ä»Žä¸Šè¿°ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼šå°†`obj`çš„`setName`å±žæ€§æŒ‡å‘ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¹¶æ‰§è¡Œ`obj.setName()`æ—¶ï¼ŒåŒ¿åå‡½æ•°ä¸­çš„`this`æŒ‡å‘äº†è°ƒç”¨çš„å¯¹è±¡`obj`ã€‚

æˆ‘ä»¬ç¨å¾®æ”¹é€ ä¸€ä¸‹ä¸Šä¸€ä¸ªä¾‹å­ï¼š

```js
const obj = {
  name: 'Mary',
  setName: function () {
  	this.name = 'Betty';
	}
};
const { setName } = obj;
setName();
console.log(obj.name); // 'Mary'
```

åŒæ ·æ˜¯æ‰§è¡Œobjå¯¹è±¡ä¸­çš„setNameæ–¹æ³•ï¼Œä¸ºä»€ä¹ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŒ¿åå‡½æ•°ä¸­çš„`this`æŒ‡å‘äº†windowï¼Ÿ

å¾ˆæ˜¾ç„¶ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨èµ‹å€¼è¯­å¥ï¼Œåˆ›å»ºä¸€ä¸ª`setName`å˜é‡ï¼Œå¹¶å°†`obj.setName`èµ‹å€¼ç»™`setName`ï¼Œå¹¶æ‰§è¡Œ`setName()`ã€‚

å‘çŽ°æ²¡æœ‰ï¼Œæˆ‘ä»¬æ‰§è¡Œçš„åªæ˜¯ä¸€ä¸ª**ç›´æŽ¥è°ƒç”¨**æ“ä½œï¼Œè®©æˆ‘ä»¬é»˜é»˜å¤ä¹ ä¸€éï¼š

**å‡½æ•°ä½œä¸ºå‡½æ•°ç›´æŽ¥è°ƒç”¨æ—¶ï¼Œéžä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œthisçš„æŒ‡å‘ç»‘å®šåˆ°windowï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œthisçš„æŒ‡å‘undefinedã€‚**

## 3. é€šè¿‡`apply()`/`call()`çš„æ–¹å¼è°ƒç”¨

```js
function setName(name) {
  this.name = name;
}
const obj = {
  name: 'Mary'
};
setName.call(obj, 'Betty'); // ä½¿ç”¨objä½œä¸ºsetNameæ‰§è¡Œæ—¶çš„thiså€¼
console.log(obj.name); // 'Betty'
```

`apply()`/`call()`æ˜¯Jså†…ç½®çš„`Function`å¯¹è±¡æä¾›çš„æ–¹æ³•ï¼Œç”¨äºŽæ˜¾å¼çš„ç»‘å®šå‡½æ•°è°ƒç”¨æ—¶çš„`this`å€¼ã€‚

`apply()`ä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„ `this` å€¼å’Œå•ç‹¬ç»™å‡ºçš„ä¸€ä¸ªå‚æ•°æ•°ç»„æ¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚

`call()`æ–¹æ³•çš„ä½œç”¨å’Œ` apply()` æ–¹æ³•ç±»ä¼¼ï¼ŒåŒºåˆ«å°±æ˜¯`call()`æ–¹æ³•æŽ¥å—çš„æ˜¯**å‚æ•°åˆ—è¡¨**ï¼Œè€Œ`apply()`æ–¹æ³•æŽ¥å—çš„æ˜¯**ä¸€ä¸ªå‚æ•°æ•°ç»„**ã€‚

## 4. ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨

```js
function Person(name) {
  this.name = name;
}

const betty = new Person('Betty');
console.log(betty.name); // 'Betty';
```

ä»€ä¹ˆæ˜¯æž„é€ å‡½æ•°ï¼Ÿ

ä½¿ç”¨`new`æ“ä½œç¬¦æ¥è°ƒç”¨ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œå°±ä¼šæŠŠè¿™ä¸ªå‡½æ•°å˜æˆæž„é€ å‡½æ•°ã€‚

è¿™å’Œ`this`æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ

è¿˜æ˜¯è®©æˆ‘ä»¬æ¥çœ‹çœ‹`new`å…·ä½“åšäº†äº›ä»€ä¹ˆå§ï¼š

1. ä»¥æž„é€ å‡½æ•°ä¸ºåŽŸåž‹åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼›
2. ä»¥æ–°å¯¹è±¡ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ‰§è¡Œæž„é€ å‡½æ•°ï¼›
3. è¿”å›žæ–°å¯¹è±¡ã€‚

**ä»¥æ–°å¯¹è±¡ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ‰§è¡Œæž„é€ å‡½æ•°ã€‚** è¿™ä¸å°±æ˜¯`call()`å’Œ`apply()`çš„å·¥ä½œï¼Ÿç”¨ä¼ªä»£ç æ¥å†™ï¼Œç›¸å½“äºŽæ‰§è¡Œäº†ä¸€ä¸ª`constructor.call(newObj)`ã€‚

æ˜¾ç„¶ï¼Œ**å‡½æ•°ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨æ—¶ï¼Œ`this`æŒ‡å‘å®žä¾‹åŒ–çš„æ–°å¯¹è±¡ã€‚**

## ç®­å¤´å‡½æ•°å’Œbind()

é™¤äº†ä¸Šè¿°å‡½æ•°çš„è°ƒç”¨æ–¹æ³•å¤–ï¼Œå‡½æ•°çš„å®šä¹‰æ–¹å¼åŒæ ·å½±å“ç€`this`çš„æŒ‡å‘ã€‚

1. **ç®­å¤´å‡½æ•°**ä¸ä¼šåˆ›å»ºè‡ªå·±çš„`this`,å®ƒåªä¼šä»Žè‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿`this`ã€‚ 

> âš ï¸1. ç®­å¤´å‡½æ•°æ²¡æœ‰prototypeï¼›2. ä½¿ç”¨`call()`/`apply()`è°ƒç”¨æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ— æ•ˆã€‚ 3. ä½¿ç”¨`new`æ“ä½œç¬¦è°ƒç”¨ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚

```js
function Person() {
  this.name = '';
  const setName1 = () => {
    this.name = 'Apple';
  }
  function setName2() {
    this.name = 'Mary';
  }
  setName1();
  setName2();
}
const betty = new Person();
console.log(betty.name); // 'Apple'
console.log(window.name); // 'Mary'
```

- `setName1()`æ˜¯ç®­å¤´å‡½æ•°ï¼Œ`this`ç»§æ‰¿äºŽä½œç”¨åŸŸé“¾ä¸Šå±‚ï¼Œå³ç»§æ‰¿äºŽå®žä¾‹å¯¹è±¡`betty`
- `setName2()`æ˜¯ç›´æŽ¥è°ƒç”¨æ–¹å¼è°ƒç”¨çš„å‡½æ•°ï¼Œå†å¤ä¹ ä¸€éï¼š**å‡½æ•°ä½œä¸ºå‡½æ•°ç›´æŽ¥è°ƒç”¨æ—¶ï¼Œéžä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œthisçš„æŒ‡å‘ç»‘å®šåˆ°windowï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œthisçš„æŒ‡å‘undefinedã€‚**

2.  `bind()` æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨ `bind()` è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„ `this` è¢«æŒ‡å®šä¸º `bind()` çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œå…¶ä½™å‚æ•°å°†ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ï¼Œä¾›è°ƒç”¨æ—¶ä½¿ç”¨ã€‚ä¸Ž`apply()`å’Œ`call()`ä¸åŒï¼Œ`bind()`è¿”å›žä¸€ä¸ªåŽŸå‡½æ•°çš„æ‹·è´ï¼Œå¹¶æ‹¥æœ‰æŒ‡å®šçš„thiså€¼å’Œåˆå§‹å‚æ•°ã€‚

```js
function setName(name) {
  this.name = name;
}
const obj = {
  name: ''
};
const bindSetName = setName.bind(obj);
bindSetName('Mary');
console.log(obj.name); // 'Mary'
```

## thisç»‘å®šçš„ä¼˜å…ˆçº§

é‚£ä¹ˆï¼Œè¿™å››ç§è°ƒç”¨æ–¹å¼ï¼Œ`this`ç»‘å®šçš„ä¼˜å…ˆçº§æ˜¯æ€Žæ ·çš„å‘¢ï¼Ÿ

**ç›´æŽ¥è°ƒç”¨**ï¼Œæ˜¾ç„¶ä¸å…·å¤‡å¯æ¯”æ€§ï¼Œå½“æˆ‘ä»¬æ»¡è¶³ç›´æŽ¥è°ƒç”¨çš„è¦æ±‚æ—¶ï¼Œå¿…ç„¶ä¸æ»¡è¶³å…¶ä»–è°ƒç”¨çš„æ–¹å¼ã€‚

é‚£ä¹ˆ**ä½œä¸ºæ–¹æ³•è°ƒç”¨**ï¼Œå’Œ**ä½¿ç”¨`apply()`/`call()`è°ƒç”¨**ï¼Œè°çš„ä¼˜å…ˆçº§æ›´é«˜å‘¢ï¼Ÿ

```js
function setName(name) {
  this.name = name;
}
const obj1 = {
  name: 'Mary',
  setName
};
const obj2 = {
  name: 'Apple'
};
obj1.setName.call(obj2, 'Betty'); 
console.log(obj1.name); // 'Mary'
console.log(obj2.name); // 'Betty'
```

`apply()`/`call()`é€‰æ‰‹èŽ·èƒœï¼ðŸ’¯

å†æ¥çœ‹çœ‹**ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨**å’Œ**ä½¿ç”¨`apply()`/`call()`è°ƒç”¨**ä¸¤è€…çš„æ¯”è¾ƒã€‚å› ä¸º`new`æ“ä½œç¬¦å’Œ`call()`/`apply()`æ— æ³•ä¸€èµ·ä½¿ç”¨ï¼Œæˆ‘ä»¬ä½¿ç”¨åŠŸèƒ½ç›¸ä¼¼çš„`bind()`æ¥è¿›è¡Œæ¯”è¾ƒã€‚

```js
function setName(name) {
  this.name = name;
}
const obj1 = {
  name: 'Mary',
};
const copySetName = setName.bind(obj1);
const apple = new copySetName('Apple');
console.log(obj1.name); // 'Mary'
console.log(apple.name); // 'Apple'
```

çœ‹æ¥ï¼Œå³ä½¿æˆ‘ä»¬å·å·çš„å°†`copySetName`çš„`this`ç»‘å®šåˆ°`obj1`ï¼Œ`new`æ“ä½œç¬¦ä¾æ—§åšæŒå·¥ä½œç€ã€‚ðŸ’¯

## æ€»ç»“

1. å‡½æ•°è°ƒç”¨çš„æ–¹å¼é€šå¸¸åˆ†ä¸ºå››ç§ï¼šç›´æŽ¥è°ƒç”¨ï¼›ä½œä¸ºæ–¹æ³•è°ƒç”¨ï¼›é€šè¿‡`apply()`/`call()`/`bind()`çš„æ–¹å¼è°ƒç”¨ï¼›ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨ã€‚
2. å‡½æ•°çš„è°ƒç”¨æ–¹å¼å½±å“äº†`this`çš„å–å€¼ï¼š

- ç›´æŽ¥è°ƒç”¨ï¼šéžä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ`this`çš„æŒ‡å‘ç»‘å®šåˆ°windowï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ`this`çš„æŒ‡å‘undefinedï¼›
- ä½œä¸ºæ–¹æ³•è°ƒç”¨ï¼š`this`æŒ‡å‘è°ƒç”¨çš„å¯¹è±¡ï¼›
- é€šè¿‡`apply()`/`call()`/`bind()`çš„æ–¹å¼è°ƒç”¨: `this`æŒ‡å‘ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›
- ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨ï¼š`this`æŒ‡å‘å®žä¾‹å¯¹è±¡æœ¬èº«ã€‚

3. å‡½æ•°çš„å®šä¹‰æ–¹å¼åŒæ ·å½±å“äº†`this`çš„å–å€¼ï¼š

- ç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„`this`,å®ƒåªä¼šä»Žè‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿`this`ã€‚
- `bind()`è¿”å›žä¸€ä¸ªæ‹¥æœ‰æŒ‡å®šçš„`this`å’Œåˆå§‹å‚æ•°çš„åŽŸå‡½æ•°çš„æ‹·è´ã€‚

4. ä¸åŒè°ƒç”¨æ–¹å¼`this`ç»‘å®šçš„ä¼˜å…ˆçº§ï¼š**ä½œä¸ºæž„é€ å‡½æ•°è°ƒç”¨** > **é€šè¿‡`apply()`/`call()`çš„æ–¹å¼è°ƒç”¨** > **ä½œä¸ºæ–¹æ³•è°ƒç”¨**ã€‚



