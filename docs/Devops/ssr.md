# SSR

## hydration

Hydration（中文常译为“水合”或“客户端激活”）是一个在现代前端开发中常见的概念，特别是在使用服务器端渲染（Server-Side Rendering, SSR）或静态站点生成（Static Site Generation, SSG）的框架和库中。这个过程涉及到在服务器上生成 HTML 内容，然后在客户端上附加事件监听器和其他交互能力。

在 SSR 或 SSG 的上下文中，Hydration 的步骤通常如下：

1. 服务器端渲染：服务器运行 React、Vue、Angular 或其他框架的应用代码，生成对应的 HTML，并将其发送给客户端（浏览器）。这个 HTML 包含了应用的初始状态，但它是静态的，没有交互能力。

2. 发送到客户端：浏览器接收到这个 HTML 并显示给用户，用户可以立即看到内容，这提高了 perceived performance（感知性能）。

3. 客户端激活 / 水合：一旦浏览器加载了 JavaScript 文件，框架会“激活”这些静态 HTML，将其转换成动态的、可以交互的应用。这个过程就是所谓的“hydration”，框架会在现有的 DOM 上附加事件处理器，绑定数据等，使得页面可以响应用户的交互。

Hydration 的关键在于，它允许服务器渲染的应用保持快速的首屏加载时间，同时也能提供丰富的客户端交互体验。这是通过避免完整的客户端渲染来实现的，因为客户端渲染需要下载 JavaScript，然后完全在浏览器中构建页面，这可能会导致较慢的首屏显示。

Hydration 还需要确保客户端生成的 DOM 完全匹配服务器生成的 DOM。如果不匹配，可能会导致错误或者需要重新渲染，这会降低性能并可能导致闪烁现象。

现代前端框架，如 React 的 ReactDOM.hydrate() 方法，Vue 的 createSSRApp 和 Nuxt.js，以及 Angular 的 Universal，都提供了支持 hydration 的工具和方法。这些工具通常会处理好客户端和服务器端 DOM 的匹配问题，让开发者可以更容易地实现 SSR 或 SSG 应用。

## SSR
服务器端渲染（Server-Side Rendering, SSR）和静态站点生成（Static Site Generation, SSG）各自适合不同类型的项目。选择使用它们通常取决于项目的需求、性能目标、内容更新频率、SEO（搜索引擎优化）要求以及开发和维护的复杂性。以下是一些适合使用 SSR 或 SSG 的场景：

适合使用 SSR 的项目：
SEO 敏感型应用：对于需要优化搜索引擎排名的应用，SSR 可以确保搜索引擎爬虫抓取到完整的页面内容，因为内容是在服务器上生成的。

首屏加载性能关键的应用：SSR 可以提供更快的首屏渲染时间，因为用户不需要等待 JavaScript 文件下载和执行即可看到完整的页面内容。

动态内容丰富的应用：对于内容经常变化的应用，如新闻网站、社交媒体平台或电子商务网站，SSR 可以确保用户总是看到最新的内容。

用户体验要求高的应用：SSR 可以提供更平滑的用户体验，因为页面内容可以更快地呈现给用户，减少了白屏时间。

适合使用 SSG 的项目：
内容静态或不经常更新的网站：对于内容不经常变化的网站，如博客、文档或营销网站，SSG 可以在构建时生成所有页面，这样服务器只需提供静态文件，提高了性能和可靠性。

高安全性要求的网站：静态网站没有服务器端代码执行，因此减少了安全漏洞的风险。

托管和缩放简单的网站：静态文件可以轻松地部署到全球的 CDN（内容分发网络），这样可以提供快速的加载时间并轻松地扩展以应对高流量。

开发和部署成本敏感的项目：SSG 网站通常更容易开发和部署，因为它们不依赖于服务器端环境和数据库。

混合模式：
一些现代框架（如 Next.js、Nuxt.js、Gatsby 等）提供了 SSR 和 SSG 的混合模式，允许开发者根据每个页面的需求选择最合适的渲染方式。例如，你可以为主页和营销页面使用 SSG，而对于产品列表和用户评论等动态内容使用 SSR。

在选择 SSR、SSG 或混合模式时，重要的是要考虑项目的具体需求，并权衡不同方法的优缺点。有时候，甚至可以考虑使用客户端渲染（Client-Side Rendering, CSR）或增量静态生成（Incremental Static Regeneration, ISR）等其他策略。