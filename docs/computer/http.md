# http

## 请求方法

| 方法    | 特点                                          |
| ------- | --------------------------------------------- |
| GET     | 幂等                                          |
| POST    | 非幂等                                        |
| PUT     | 幂等，向指定位置上传最新内容                  |
| HEAD    | 类似 POST，但服务器不返回 body，仅返回 header |
| TRACE   | 回显服务器收到的请求，用于 debug              |
| OPTIONS | 访问接口支持的所有 http 请求方法              |
| DELETE  | 删除文件                                      |
| CONNECT | 用于 SSL 加密的服务器链接，协议提升           |

## 通用头

| 名称              | 含义                     |
| ----------------- | ------------------------ |
| Date              | 消息发送时间             |
| Cache-Control     | 控制缓存相关             |
| Transfer-Encoding | 表示消息主体的编码格式   |
| Connection        | 是否需要持久连接         |
| Upgrade           | 要求服务升级到高版本协议 |

## 请求头

| 名称             | 含义                                                         |
| ---------------- | ------------------------------------------------------------ |
| Authorization    | 身份认证数据                                                 |
| If-Modfied-Since |                                                              |
| If-Match         |                                                              |
| If-None-Match    |                                                              |
| Range            | 请求部分资源，指定资源范围                                   |
| Referer          | 通过点击超级链接进入下一个页面时，在这里记录上一个页面的 URI |

## 响应头

| 名称          | 含义                                                                |
| ------------- | ------------------------------------------------------------------- |
| Location      | 信息的准确位置。当前请求 URI 为相对路径时，该字段用来返回绝对路径   |
| Accept-Ranges | 当希望仅请求部分数据（使用 Range 指定），服务器会告知客户端是否支持 |

## 实体头

| 名称           | 含义                                       |
| -------------- | ------------------------------------------ |
| Expires        | body 的有效期                              |
| Last-Modified  |                                            |
| Etag           | 资源的唯一标识                             |
| Content-Type   | body 的数据类型                            |
| Content-Length | body 的长度                                |
| Content-Range  | 仅请求部分数据时，表示 body 包含的数据范围 |
| Allow          | 指定 URI 支持的方法                        |

## 响应码

### 1xx 信息

| 名称 | 含义                                          |
| ---- | --------------------------------------------- |
| 100  | 服务器仅接收到部分请求，客户端应到继续发送    |
| 101  | 服务器转换协议，用于 websocket 的转换         |
| 103  | 用于 PUT 或 POST 请求回复失败时的回复请求建议 |

### 2xx 成功

| 名称 | 含义                                                                   |
| ---- | ---------------------------------------------------------------------- |
| 200  | success                                                                |
| 201  | 请求被创建完成(PUT)                                                    |
| 202  | 请求已被接受，但处理未完成                                             |
| 203  | 请求已被成功处理，但是一些响应头可能不正确，因为使用的所其他文档的拷贝 |
| 204  | 浏览器应当继续显示原来的文档                                           |
| 205  | 刷新页面，用于清除表单输入内容                                         |
| 206  | 带 range 的 get 已完成，视频加载通常使用该状态码                       |

### 3xx 重定向

| 名称 | 含义                                        |
| ---- | ------------------------------------------- |
| 300  | 多重选择，用户可以多选重定向地址，最多 5 个 |
| 301  | 所请求但页面已移至新但 URL，永久重定向      |
| 302  | 临时重定向，实际实现：POST 重定向为 GET     |
| 304  | 缓存                                        |
| 305  | 应当通过 Location 所指定的代理服务器读取    |
| 306  | 已废弃，更换代理                            |
| 307  | 临时重定向                                  |
| 308  | 永久重定向                                  |

### 4xx 客户端错误

| 名称 | 含义                 |
| ---- | -------------------- |
| 400  | 烂请求               |
| 401  | 需要认证             |
| 403  | 权限不足             |
| 404  | 找不到资源           |
| 405  | 方法不被允许         |
| 406  | 无法解析返回数据格式 |
| 408  | 超出服务端等待时间   |
| 414  | URL 太长             |

### 5xx 服务端错误

| 名称 | 含义                                   |
| ---- | -------------------------------------- |
| 500  | 无法预计的服务器错误                   |
| 501  | 服务器不支持所请求的功能               |
| 502  | 网关错误，上游返回错误                 |
| 503  | 服务不可用                             |
| 504  | 网关超时                               |
| 505  | HTTP 协议版本不支持                    |
| 511  | 用户需要提供身份验证来获取网络访问入口 |

## 版本

### 1.1

增加了 keep-alive

### 2.0

1. 二进制分帧
2. 头部信息压缩
3. 多路复用，多个请求复用一条 TCP 连接
4. 服务器推送

### 3.0

QUIC

## https

https 数据传输过程中，使用 SSL/TLS 对数据进行加密，使用 http 对加密后的数据进行传输。所以:

> https = http + SSL/TLS。

SSL 全称为 Secure Socket Layer，即安全套接层协议，是为网络通信提供安全及数据完整性的一种安全协议。

TLS 全称为 Transfer Layer Security，安全传输层协议，是 SSL3.0 的后续版本。

### 对称加密

对称加密又称为公钥加密。即信息的发送方和接收方使用同一个密钥去进行信息的加密或解密。  
加密：明文 + 公钥 + 加密算法 => 密文  
解密：密文 + 公钥 + 解密算法 => 明文

### 非对称加密

非对称加密又称为私钥加密。  
加密：明文 + 公钥 + 加密算法 => 密文  
解密：密文 + 私钥 + 解密算法 => 明文

### https 流程

![https](../assets/https.jpg)

### 证书验证流程

浏览器第一次 http 连接后从服务端收到证书，即公钥，并尝试寻找根证书，找到后，使用根公钥揭秘证书签名得到一个 hash 值 A 和一个 hash 算法，同时根据这个 hash 算法计算出 hash 值 B，判断 AB 是否相等，如果相等，则继续验证证书 URL 与请求 URL 是否一致，一致则生成随机密钥，并用证书公钥加密随机密钥，发送给服务端，此时进行的是第二次 http 连接。

![CA](../assets/validateCA.jpg)

## Question

1. http 报文如何分割 header 和 body？
2. 常用的请求头？
3. 常用的响应码？
4. GET 与 POST 的区别？
5. 301 和 302 的区别？
6. 304 是什么情况下使用的？
7. http 和 https 的区别？
8. 详述一下 https 的流程？
9. 如何验证证书？
